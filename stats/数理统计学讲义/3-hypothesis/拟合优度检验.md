可以先[[empirical-distribution-function]]，[[密度函数估计]]得到模型再检验
## 卡方（简单假设）
假设成立时分布函数确定唯一：简单假设（否则复杂假设）
先（不一定均匀）分成若干段（$m$个点，$m+1$段）
$\nu_i/n$：数据反映出来的落在某段的频率
$p_i$：简单假设下落在某段的概率
两者差平方，除以$p_i$作某种正规化，就是个有意义的量
因此$V:=\sum \frac{(\nu_i-np_i)^2}{np_i}$
在$H_0$下，近似有$V\sim \chi^2_m$
[[look-up]]，[[chi-square]]，如果$V$太大就拒绝
举例：星期一到星期六，离散，很自然就是5个分点，$m=5,\chi_5^2$的0.95分位数为11.07，所以$V$是否大于$11.07$就是判断标准
## 卡方（复杂假设）
（近似方法，不完全严谨）：[[maximum-likelihood]]变成简单假设，但自由度变成$m-k$
- 应用：列联表的独立性检验
对于$m*n$表，当成$m+n-2$参数的分布（注意少两个参数）
自由度$mn-1-(m+n-2)=(m-1)(n-1)$
$V$计算公式：$\hat p$就是用频率计算概率$n_i/n$
代入得$V = n[\sum\sum \frac{n_{ij}^2}{n_{i}n_j}-1]$
四格表自由度1
$V = n(\frac{a^2 bc+a^2bd+a^2 cd+a^2d^2+...}{...}-1)$
$=(16项减16项，看多的少的就行)n(\frac{a^2d^2+b^2c^2-2adbc}{...})=n(ad-bc)^2/(+)(+)(+)(+)$
## 柯氏(Kolmogorov)
回忆[[empirical-distribution-function]]中G-C定理，“误差”上界不应太大
但是怎么由$\alpha$得否定域呢？分歧度$D$分布和$F$无关（这点类比[[order-statistics]]中连续的“好”分布和均匀分布的关系）！
但$D$的分布和$n$有关。$n$小查表，大了则$\sqrt n D_n$分布近似是某个造好表的$Q$
注意这里没有-1. -1的本质是[[chi-square]]那里由于正态分布被中心化，去除了一个自由度。这里和[[chi-square]]毫无关系，就是简单造个表，是$n$就是$n$
实际工作近似方法：先极大似然！
拓展
- 类似的思想，考察某个[[stieltjes]]积分也行
- 类似的思想考察两样本分布是否相同
  - $F_{n_1}(x),G_{n_2}(x)$，$lim_{n_1,n_2}P(\sqrt{\frac{n_1n_2}{n_1+n_2}}D\le x)=Q(x)$
## 正态性
- 样本量小，W检验
  - 实质上是看$EX_{(i)}$和$X_{(i)}$（[[order-statistics]]）是否近似相等
  - 或说$X_{(i)}$和标准正态的分位数是否成线性关系，用[[系数]]$R^2$判断。这相当于做了中心化标准化
- 大，D检验
- 不过很多都是会[[look-up]]就行