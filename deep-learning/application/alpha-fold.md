# 总述
- [参考](https://zhuanlan.zhihu.com/p/393699764)
- 问题：输入氨基酸序列，输出$\phi, \psi$夹角对
  - 输入$k$个氨基酸，输出$k-1$个这样的夹角
- 总体方法
  - 首先利用[[msa]]等多种方法作特征工程
  - 过一个网络预测距离/夹角分布
    - **一般炼丹人的视角：到这里就结束了**
  - 利用刚刚的结果生成一个初始化点，同时有个landscape
  - 在landscape上梯度下降得到结果
# 特征提取
- $O(k)$特征
  - 加入专家知识
  - 使用[[msa]]和已有大数据库中的序列作某种“对齐”
  - 结果：肽链长度为$k$，得到$(k,m)$的序列特征矩阵，$m$为特征维度
    - 思考：[[msa]]是很强的信号，其它alpha-fold的竞争者考虑不使用它
    - 具体做法：用序列数据库，用类似nlp中的做法pretrain，大规模self-supervised. 但实际效果还干不过alphafold（超不过msa带来的信息量）
- $O(k^2)$特征
  - 把一篇其它预测两两residue（残基）关系论文的输出（及靠后层）作为特征
  - 结果：肽链长度为$k$，得到$(k,k,n)$的张量，$n$为特征维度
# 网络输出
- 把距离$2-22$埃分成64个桶，作为分类问题，计算概率，形状$k,k,64$
- 把夹角分成1296个桶，形状$k,1296$
- 但这个结果相当于一个约束，还是不能直接得到结果本身
- 这就是本篇的重要思想
  - 直接预测难，可预测其下游东西，作为约束！反推
  - 参考[[12-uncertainty]]中的概率图：可以理解成序列 -> 夹角 -> 两两距离，但夹角这个不好预测，信号难，累积误差大，不如直接预测距离，再利用某种方法反推！
- 网络以res和dilation为主
  - 训练是互不重叠小块，测试是有重叠小块
  - 避免边缘效应+[[ensemble]]思想
# 生成可微landscape
- 夹角到距离可微！
- 刚刚输出了分布，线性插值，可微！
- 额外加一个范德华项，可微
- 总之就是可微
# 梯度下降
- 结合进化算法[[4-local-search]]，随机初始化，加扰动等（联想鱼群、蚁群等）