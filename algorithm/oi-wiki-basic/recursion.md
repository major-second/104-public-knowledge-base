- 前置[[func]], [[general-principles/recursion]]
- https://oi-wiki.org/basic/divide-and-conquer/
# 概述
- 递归：分为子问题，自己调用自己
  - 如果自己太特殊了，子问题和自己相似但不完全相同，那可能要增加参数
  - 例如[[60-permutation-sequence]]
    - 自己是排列`12...n`
    - 递归时可能不一定排列`12...n`这样的，所以要增加参数
- 递归的精髓
  - `明白一个函数的作用并相信它能完成这个任务，千万不要跳进这个函数里面企图探究更多细节，否则就会陷入无穷的细节无法自拔，人脑能压几个栈啊。`
  - 参考[[116-populating-next-right-pointers-in-each-node]]
    - 一是明白函数执行条件
    - 二是明白函数执行后结论
- 优点：写起来简单。缺点：时空等效率低
  - 有时可以[[dp]], [[memo]]获得更高效率
- 如果各部分不独立，有重复子问题，就不要用分治，而是用动态规划
- 怎么分？
  - 如果把$n$分成$n+1$和$1$并不好，那就考虑$n/2$和$n/2$试试，往往可提高效率
  - 也就是递归和[[divide-and-conquer]]常常联系
# 出口条件
- 记住一定要写出口条件
  - 这时要注意[[algorithm/special-case]]！而且其实出口往往都是[[algorithm/special-case]]
# 使递推关系最简单
- 比如出现二元递推时，经常出现“一动一不动”
- 一个举例：[[10-regular-expression-matching]]
  - 三种递推关系
  - `ab, ab`变成`b, b`
  - `a*`直接被去除，不匹配任何东西
  - 在`p`中有`a*`时，`s`中的`a`直接被去除一个
    - 这里千万不要写`p`中的`a*`和`s`中的`a`一起被去除，因为这就不是最不可细分的操作了
# 和[[dp]]关系
- 一般和[[dp]]方向相反
  - 例如[[10-regular-expression-matching]]，递归从字符串前向后，而[[dp]]先看后缀是否匹配再看前面
- “可能性”数量对应
  - 例如[[10-regular-expression-matching]]，三种递推关系
    - 则在递归解法中，出现三次调用自身
    - 在递推解法中，出现三次读取自身数组的（已经计算出的）值
# 例
## 约瑟夫环
- https://zhuanlan.zhihu.com/p/35487124
- 排成一圈，每$n$个出局一个人，求最后剩下谁
  - 以下编号从0开始，所以注意[[off-by-one-errors]]
  - 递归关系：找到[[self-similarity]]即规模为$m-m//n$的问题
  - $f(1)=1$
  - 取一个特例[[general-principles/special-case]]看：$n=4,m=9$
    - 出局2人剩7人
    - 报数“计数器”“偏移”了1（本来0开始报数，变成1开始）
    - $f(7)=1$
    - 但首先往回减“偏移”1，变成0
    - 而且这个0是已经出局3, 7后，0124568中的0，而不是0123456中的1
    - 总结$g(9)=f(7)-9\%4$
    - $f(9)=g(9)+g(9)//3$
  - $g(m) =( f(m-m//n)-m\%n +m )\% m $
  - $f(m)=g(m) + g(m) // (n-1) $
- 特例：$n=2$，$m$不是2正整数幂（否则答案显然，直接套用[[fourier-transform]]中的）
  - 套结论得$f(m) =2(( f(m-m//n)-m\%n +m )\% m) $
  - 对于$m=2^n+2k,0<2k<2^n$，$f(m)=2f(2^{n-1}+k)$
  - 对于$m=2^n+2k+1,0<2k+1<2^n$，$f(m)=2f(2^{n-1}+k+1)-2$
    - 这里暂且claim $2f(2^{n-1}+k+1)-2\ge 0$
  - 通过[[induction]]可证明$m=2^n+l\Rightarrow f(m)=2l$，其中$0<l<2^n$
  - 该题变种
    - 依次报数0，1，0，1，改为0出局1留下
    - 你就把原本最后一个放到开头即可，这是[[reduction]]
      - 实质上就是一个[[off-by-one-errors]]差了1
    - 例如2000个人，编号1到2000，那你把2000放到0号位，则最后留下的是$2\times 976=1952$
      - 注：推论：还能马上得出倒数第二个是928，因为1952-1024=928